!function(){"use strict";new Vue({el:"#app",data:{loadingMask:!0,api:"https://script.google.com/macros/s/AKfycbxC425IS9ntTUJ2k1rLzyDhKmj4R5wnyTS4JFaUnysctbQ1mXAO/exec",map:null,responseData:[],heatmapData:[],tabType:"confirmed",chart:{state:"",confirmed:0,recovered:0,death:0},chartCanvas:null,toast:!1,toastLoading:!0,translate:[{Anhui:"安徽省"},{Beijing:"北京市"},{Chongqing:"重慶市"},{Fujian:"福建省"},{Gansu:"甘肅省"},{Guangdong:"廣東省"},{Guangxi:"廣西壯族自治區"},{Guizhou:"貴州省"},{Hainan:"海南省"},{Hebei:"河北省"},{Heilongjiang:"黑龍江省"},{Henan:"河南省"},{Hubei:"湖北省"},{Hunan:"湖南省"},{"Inner Mongolia":"內蒙古自治區"},{Jiangsu:"江蘇省"},{Jiangxi:"江西省"},{Jilin:"吉林省"},{Liaoning:"遼寧省"},{Ningxia:"寧夏回族自治區"},{Qinghai:"青海省"},{Shaanxi:"陝西省"},{Shandong:"山東省"},{Shanghai:"上海市"},{Shanxi:"山西省"},{Sichuan:"四川省"},{Tianjin:"天津市"},{Tibet:"西藏自治區"},{Xinjiang:"新疆維吾爾自治區"},{Yunnan:"雲南省"},{Zhejiang:"浙江省"},{Thailand:"泰國"},{Japan:"日本"},{"South Korea":"南韓"},{Taiwan:"台灣"},{Washington:"華盛頓"},{Illinois:"伊利諾伊州"},{California:"加利福尼亞"},{Arizona:"亞利桑那州"},{Macau:"澳門"},{"Hong Kong":"香港"},{Singapore:"新加坡"},{Vietnam:"越南"},{France:"法國"},{Nepal:"尼泊爾"},{Malaysia:"馬來西亞"},{Ontario:"安大略"},{"British Columbia":"英屬哥倫比亞"},{"New South Wales":"新南威爾斯州"},{Victoria:"維多利亞"},{Queensland:"昆士蘭州"},{Cambodia:"柬埔寨"},{"Sri Lanka":"斯里蘭卡"},{Germany:"德國"},{Finland:"芬蘭"},{"United Arab Emirates":"阿拉伯聯合大公國"},{Philippines:"菲律賓"},{India:"印度"},{Italy:"義大利"},{UK:"英國"},{Russia:"俄羅斯"},{Sweden:"瑞典"},{Spain:"西班牙"},{"South Australia":"南澳洲"},{"Boston, MA":"波士頓"},{Belgium:"比利時"},{"Madison, WI":"麥迪遜"},{"Chicago, IL":"芝加哥"},{"Toronto, ON":"多倫多"},{"Santa Clara, CA":"聖塔克拉拉"},{"San Benito, CA":"聖貝尼托縣"},{"Seattle, WA":"西雅圖"},{"Tempe, AZ":"坦佩"},{"Orange, CA":"橙市"},{"Los Angeles, CA":"洛杉磯"},{"London, ON":"倫敦"},{"Diamond Princess cruise ship":"鑽石公主號"},{"San Diego County, CA":"聖地牙哥郡"},{Iran:"伊朗"},{"Omaha, NE (From Diamond Princess)":"奧馬哈(從鑽石公主號)"},{"From Diamond Princess":"從鑽石公主號"},{"Travis, CA (From Diamond Princess)":"特拉維斯空軍基地(從鑽石公主號)"},{"Lackland, TX (From Diamond Princess)":"拉克蘭空軍基地(從鑽石公主號)"},{"San Antonio, TX":"聖安東尼奧"},{Egypt:"埃及"},{Lebanon:"黎巴嫩"},{"Humboldt County, CA":"洪堡縣"},{"Sacramento County, CA":"沙加緬度郡"},{Oman:"阿曼"},{Iraq:"伊拉克"},{Afghanistan:"阿富汗"},{Bahrain:"巴林"}]},methods:{initMap:function(){var e=this;fetch(this.api).then((function(e){return e.json()})).then((function(a){var t=e;e.map=new google.maps.Map(document.getElementById("map"),{center:{lat:30.97564,lng:112.2707},zoom:5,mapTypeId:"roadmap",zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0,styles:[{elementType:"geometry",stylers:[{color:"#263238"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#FFD54F"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#746855"}]},{featureType:"administrative.land_parcel",elementType:"geometry.stroke",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"geometry.stroke",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#BCAAA4"}]},{featureType:"administrative.neighborhood",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#37474F"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#263238"}]}]});for(var n=[],o=a.confirmed,r=a.recovered,i=a.death,s=function(s,l){l=Object.keys(o[0]).length-1;var c,d,p=o[s]["Province/State"].replace("--",", ")||o[s]["Country/Region"].replace("--",", "),m={};m.id=s,m.state=(c=p,d="",Array.prototype.forEach.call(t.translate,(function(e){var a=Object.keys(e)[0];if(a===c)return d=e[a]})),""!=d?d:c),m.lat=o[s].Lat,m.lng=o[s].Long,m.confirmed=Number(o[s][Object.keys(o[0])[l]])||0,m.recovered=Number(r[s][Object.keys(r[0])[l]])||0,m.death=Number(i[s][Object.keys(i[0])[l]])||0,n.push(m);var y=new google.maps.LatLng(m.lat,m.lng),h=new google.maps.Marker({position:y,map:e.map}),u=new google.maps.InfoWindow({content:"\n                <h6>".concat(m.state,"</h6>\n                <p>確診：").concat(m.confirmed,"</p>\n                <p>康復：").concat(m.recovered,"</p>\n                <p>死亡：").concat(m.death,'</p>\n                <button\n                  type="button"\n                  id="info-btn-').concat(m.id,'"\n                  class="btn btn-secondary btn-sm m-1 mt-2 for-mobile-up">\n                  <small>開啟圖表</small> \n                </button>\n              ')});m.openInfoWindow=function(){u.open(e.map,h)},u.addListener("domready",(function(t){document.getElementById("info-btn-".concat(m.id)).addEventListener("click",(function(t){e.openChartModal({state:m.state,count:{confirmed:m.confirmed,recovered:m.recovered,death:m.death},data:{confirmed:a.confirmed[s],recovered:a.recovered[s],death:a.death[s]}})}))})),h.addListener("click",(function(a){u.open(e.map,h),null!==t.chartCanvas&&t.destroyChart()}));var f={location:y,weight:m.confirmed};"Hubei"===o[s]["Province/State"]&&(f.weight=.15*m.confirmed),e.heatmapData.push(f)},l=0,c=o.length;l<c;l++)s(l,c);e.responseData=n.sort((function(e,a){return e.confirmed>a.confirmed?-1:1})),new google.maps.visualization.HeatmapLayer({data:e.heatmapData,dissipating:!0,radius:40}).setMap(e.map),e.loadingMask=!1}))},showCount:function(e,a,t){return"confirmed"===this.tabType?e:"recovered"===this.tabType?a:"death"===this.tabType?t:void 0},openChartModal:function(e){null!==this.chartCanvas&&this.destroyChart(),this.toast=!0,this.toastLoading=!0,this.chart.state=e.state,this.chart.confirmed=e.count.confirmed,this.chart.recovered=e.count.recovered,this.chart.death=e.count.death;var a=Object.keys(e.data.confirmed);a=a.slice(4,a.length);var t=Object.keys(e.data.recovered);t=t.slice(4,t.length);var n=Object.keys(e.data.death);n=n.slice(4,n.length);var o=[];Array.prototype.forEach.call(a,(function(e){o.push(e.split("/20")[0])}));var r=[],i=[],s=[];Array.prototype.forEach.call(a,(function(a){var t=Number(e.data.confirmed[a])||0;r.push(t)})),Array.prototype.forEach.call(t,(function(a){var t=Number(e.data.recovered[a])||0;i.push(t)})),Array.prototype.forEach.call(n,(function(a){var t=Number(e.data.death[a])||0;s.push(t)}));var l={type:"line",data:{labels:o,datasets:[{label:"確診",backgroundColor:"#2196F3",borderColor:"#2196F3",data:r,fill:!1},{label:"康復",backgroundColor:"#4CAF50",borderColor:"#4CAF50",data:i,fill:!1},{label:"死亡",backgroundColor:"#f44336",borderColor:"#f44336",data:s,fill:!1}]},options:{responsive:!0,tooltips:{mode:"index",intersect:!1},hover:{mode:"nearest",intersect:!0},scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:"日期"}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"人數"}}]}}},c=document.getElementById("data-chart").getContext("2d");this.chartCanvas=new Chart(c,l),this.toastLoading=!1},destroyChart:function(){this.toast=!1,this.chartCanvas.destroy()},moveMapCenter:function(e,a,t){var n=new google.maps.LatLng(e,a);this.map.panTo(n),t.openInfoWindow()}},created:function(){var e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBG9pWjn7gWHoqsNqTrU2EpWfZkyTlh6_I&libraries=visualization",document.head.appendChild(e),e.onload=this.initMap}})}();